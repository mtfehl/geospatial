year(as.Date('10-01-1959'))
datasets::AirPassengers
df.airqual <- data.table(airquality)
df.months <- data.table(Month = 1:12, month.text = month.name)
merge.data.table(df.airqual,df.months)
df.merged <- merge.data.table(df.airqual,df.months)
df.airqual
df.months
df.merged <- df.airqual %>%
left_join(df.months)
library(dplyr)
df.merged <- df.airqual %>%
left_join(df.months)
df.merged
df.merged <- tibble(df.merged)
df.merged # Better way of visualizing data frames.
df.merged %>%
select(month.text, Day, Wind)
save(df.merged,file = 'merged_dataset.rdata') # can also be .rds
fwrite(x = df.merged,file = 'merged_dataset.csv', sep = '\t')
getwd()
df.ex.1 <- data.table(datasets::CO2)
df.ex.1
df.ex.2 <- data.table(datasets::state.x77)
df.ex.2
library(sf) # simple features' library
library(spData) # library of spatial datasets
library(tidyverse) # dplyr, ggplot, ...
gm.point <- st_point(c(5,2)) # a point
gm.point
linestring_matrix <-rbind(c(1, 5), c(4, 4), c(4, 1), c(2, 2), c(3, 2))
linestring_matrix
gm.line <- st_linestring(linestring_matrix)
gm.line
polygon_list <- list(rbind(c(1, 5), c(2, 2), c(4, 1), c(4, 4), c(1, 5)))
gm.polyg <- st_polygon(polygon_list)
gm.polyg
gm.multipoints <- st_multipoint(linestring_matrix)
gm.multipoints
multiline_list <- list(rbind(c(1, 5), c(4, 4), c(4, 1), c(2, 2), c(3, 2)),
rbind(c(1, 2), c(2, 4)))
multiline_list
gm.multilines <- st_multilinestring((multiline_list))
gm.multilines
multipolygon_list <- list(list(rbind(c(1, 5), c(2, 2), c(4, 1), c(4, 4), c(1, 5))),
list(rbind(c(0, 2), c(1, 2), c(1, 3), c(0, 3), c(0, 2))))
multipolygon_list
gm.multipolyg <- st_multipolygon(multipolygon_list)
gm.multipolyg
gm.point <- st_point(c(11.3, 44.4)) # c(longitude,latitude)
gm.point
gmc.point <- st_sfc(gm.point,crs = 'EPSG:4326')
gmc.point
df.attr <- data.frame(
name = 'Bologna',
temperature = 31,
language = 'Italian'
)
df.attr
gmsf.point <- st_sf(df.attr,geometry = gmc.point)
gmsf.point
gmsf.point[,'name']
gmsf.point %>%
select(name) # dplyr syntax
st_geometry(gmsf.point)
ggplot(gmsf.point) +
geom_sf()
ggplot(gmsf.point) +
geom_sf(aes(color=name))
gmsf.world <- world
gmsf.world
ggplot(gmsf.world) +
geom_sf(aes(fill=continent))
ggplot(gmsf.world) +
geom_sf(aes(fill=name_long))
ggplot(gmsf.world) +
geom_sf(aes(fill=name_long)) +
theme(legend.position = "none")
ggplot(gmsf.world) +
geom_sf(aes(fill=continent))
ggplot(gmsf.world) +
geom_sf(aes(fill=name_long)) +
theme(legend.position = "none")
ggplot() + # leave empty, add data to geometry
geom_sf(data = gmsf.world) +
geom_sf(data = gmsf.point)
ggplot() + # leave empty, add data to geometry
geom_sf(data = gmsf.world) +
geom_sf(data = gmsf.point, aes(color = name)) +
theme_bw()
ggplot() + # leave empty, add data to geometry
geom_sf(data = gmsf.world, aes(fill = continent)) +
geom_sf(data = gmsf.point)
rm(list = ls()) # cleaning envrionment
df.cities <- data.frame(
name = c('Bologna', 'London', 'Madrid', 'Paris'),
temperature = c(31, 21, 29,28),
language = c('Italian', 'English', 'Spanish', 'French'),
longitude = c(11.3,-0.1,-3.7,2.3),
latitude = c(44.4,51.5, 40.4,48.8)
)
df.cities
sf.cities <- st_as_sf(df.cities,coords = c('longitude', 'latitude'))
sf.cities
sf.cities <- st_as_sf(
df.cities,
coords = c('longitude', 'latitude'),
crs = 'EPSG:4326'
)
sf.cities
sf.cities
ggplot() + # leave empty, add data to geometry
geom_sf(data = world) +
geom_sf(data = sf.cities, aes(color = name))
ggplot() + # leave empty, add data to geometry
geom_sf(data = world, aes(fill=continent)) +
geom_sf(data = sf.cities, aes(shape = language))
save(sf.cities, 'sf_cities.rdata') # or .rds
save(sf.cities, 'sf_cities.rdata') # or .rds
save(sf.cities, 'sf_cities.rdata') # or .rds
st_write(sf.cities,'Sandbox/sf_cities.shp')
getwd()
setwd("C:/Users/T14/7Programming/R/class/geospatial/notes/01")
save(sf.cities, 'sf_cities.rdata') # or .rds
setwd("C:/Users/T14/7Programming/R/class/geospatial/notes/01/")
save(sf.cities, 'sf_cities.rdata') # or .rds
sf.provinces <- st_read('../../../Downloads/ne_110m_admin_1_states_provinces/', 'ne_110m_admin_1_states_provinces')
linestring_matrix <-rbind(c(1, 5), c(4, 4), c(4, 1), c(2, 2), c(3, 2))
linestring_matrix
linestring_matrix <- rbind(c(3.2, 4), c( 4, 4.6), c(3.8, 4.4),
c(3.5, 3.8), c(3.4, 3.6), c(3.9, 4.5))
gm.multipt <- st_multipoint(linestring_matrix)
gm.multipt
multipt_matrix <- rbind(c(3.2, 4), c( 4, 4.6), c(3.8, 4.4),
c(3.5, 3.8), c(3.4, 3.6), c(3.9, 4.5))
gm.multipt <- st_multipoint(multipt_matrix)
linestring_matrix <- rbind(c(0, 3), c(0,4), c(1,5), c(2,5))
gm.linestr <- st_linestring(linestring_matrix)
gm.linestr
polygon_matrix <- list(rbind(c(0,0), c(1,0), c(3,2), c(2,4),
c(1,4), c(0,0)))
polygon_matrix
gm.poly <- st_polygon(polygon_matrix)
gm.poly
mock_data <- data.frame(points = gm.multipt,
lines = gm.linestr,
polygons = gm.poly)
geom <- c(gm.multipt, gm.linestr, gm.poly)
geom
data.frame(objects = c('multipt', 'linestr', 'polyg'),
geometry = geom)
mock_data <- data.frame(objects = c('multipt', 'linestr', 'polyg'),
geometry = st_sf(geom))
mock_data <- data.frame(objects = c('multipt', 'linestr', 'polyg'),
geometry = st_as_sfc(geom))
mock_data <- data.frame(objects = c('multipt', 'linestr', 'polyg'),
geometry = st_as_sf(geom))
mock_data <- data.frame(objects = c('multipt', 'linestr', 'polyg'),
geometry = st_to_sf(geom))
gm.point <- st_point(c(11.3, 44.4)) # c(longitude,latitude)
gmc.point <- st_sfc(gm.point,crs = 'EPSG:4326')
gmc.point
gm.point
mock_data <- data.frame(objects = c('multipt', 'linestr', 'polyg'))
mock_data
sf_mockdata <- st_sf(mock_data, geometry = geom)
mock_data <- data.frame(objects = c('multipt', 'linestr', 'polyg'))
mock_data
gm.multipt
gm.linestr
gm.poly
geom <- c(gm.multipt, gm.linestr, gm.poly)
geom
sf_mockdata <- st_sf(mock_data, geometry = c(gm.multipt, gm.linestr, gm.poly))
sf_mockdata <- st_sf(mock_data, geometry = gm.multipt)
gm.multipt <- st_multipoint(multipt_matrix)
gm.multipt
sf_mockdata <- st_sf(mock_data, geometry = gm.multipt)
geom <- st_sfc(c(gm.multipt, gm.linestr, gm.poly))
st_sfc(gm.multipt)
geom
sf_mockdata <- st_sf(mock_data, geometry = geom)
sf_mockdata
geom
geom <- st_sfc(gm.multipt, gm.linestr, gm.poly)
geom
sf_mockdata <- st_sf(mock_data, geometry = geom)
sf_mockdata
ggplot(sf_mockdata)
ggplot() +
geom_sf(data=sf_mockdata)
setwd("C:/Users/T14/7Programming/R/class/geospatial/notes/01/")
airports <- st_read("ne_10m_airports/ne_10m_airports_shp")
airports <- st_read("ne_10m_airports/ne_10m_airports.shp")
airports
colnames(airports)
head(st_read)
head(airports)
ggplot() +
geom_sf(data=airports, aes(fill=type))
ggplot() +
geom_sf(data=gmsf.world) +
geom_sf(data=airports, aes(fill=type))
gmsf.world <- world # empty world map
ggplot() +
geom_sf(data=gmsf.world) +
geom_sf(data=airports, aes(fill=type))
ggplot() +
geom_sf(data=gmsf.world) +
geom_sf(data=airports, aes(color=type))
reticulate::repl_python()
library(reticulate)
use_virtualenv("r-reticulate", required = TRUE)
reticulate::py_install(c("geopandas", "pandas", "xarray", "rioxarray", "folium"), envname = "r-reticulate")
reticulate::install_python()
reticulate::virtualenv_create("r-reticulate")
reticulate::virtualenv_install("r-reticulate", packages = c("geopandas", "pandas", "xarray", "rioxarray", "folium", "mapclassify"))
library(reticulate)
use_virtualenv("r-reticulate")
library(reticulate)
use_virtualenv("r-reticulate")
reticulate::repl_python()
reticulate::virtualenv_install("r-reticulate", packages = c("libpysal", "spreg", "mgwr"))
library(reticulate)
use_virtualenv("r-reticulate")
library(reticulate)
use_virtualenv("r-reticulate")
reticulate::repl_python()
# multipoint (think: long-lat)
multipt_matrix <- rbind(c(3.2, 4), c( 4, 4.6), c(3.8, 4.4),
c(3.5, 3.8), c(3.4, 3.6), c(3.9, 4.5))
gm.multipt <- st_multipoint(multipt_matrix)
packages <- c("tidyverse",        # tidyverse universe
"sf",               # vectorized spatial data
"sp",               #
"spData",           #
"terra",            #
"exactextractr",    #
"raster",           #
"gdistance",        #
"data.table",       # high-dimension, fast data computation
"haven",            # load/save Stata .dta files
"leaflet")          # interactive dashboards
packages(1)
packages[1]
packages <- c("tidyverse",        # tidyverse universe
"sf",               # vectorized spatial data
"sp",               #
"spData",           #
"terra",            #
"exactextractr",    #
"raster",           #
"gdistance",        #
"data.table",       # high-dimension, fast data computation
"haven",            # load/save Stata .dta files
"leaflet")          # interactive dashboards
for (i in packages) {
library(packages[i], character.only = TRUE)
}
libs <- c("tidyverse",        # tidyverse universe
"sf",               # vectorized spatial data
"sp",               #
"spData",           #
"terra",            #
"exactextractr",    #
"raster",           #
"gdistance",        #
"data.table",       # high-dimension, fast data computation
"haven",            # load/save Stata .dta files
"leaflet")          # interactive dashboards
for (i in libs) {
library(i, character.only = TRUE)
}
setwd("C:/Users/T14/7Programming/R/class/geospatial/notes/01/")
airports <- st_read("ne_10m_airports/ne_10m_airports.shp")
# set up
setwd("C:/Users/T14/7Programming/R/class/geospatial/notes/01")
rm(list=ls())
libs <- c("tidyverse",            # tidyverse universe
"sf",               # vectorized spatial data
"sp",               #
"spData",           #
"terra",            #
"exactextractr",    #
"raster",           #
"gdistance",        #
"data.table",       # high-dimension, fast data computation
"haven",            # import/save Stata .dta files
"leaflet")          # interactive dashboards
for (i in libs){
if (!require(i, character.only = TRUE)){
install.packages(i)
library(i, character.only = TRUE)
} else{
library(i, character.only = TRUE)
}
}
# multipoint (think: long-lat)
multipt_matrix <- rbind(c(3.2, 4), c( 4, 4.6), c(3.8, 4.4),
c(3.5, 3.8), c(3.4, 3.6), c(3.9, 4.5))
gm.multipt <- st_multipoint(multipt_matrix)
# linestring (connecting pts; order matters)
linestring_matrix <- rbind(c(0, 3), c(0,4), c(1,5), c(2,5))
gm.linestr <- st_linestring(linestring_matrix)
# polygon (last pt & first pt must match)
polygon_matrix <- list(rbind(c(0,0), c(1,0), c(3,2), c(2,4),
c(1,4), c(0,0)))
gm.poly <- st_polygon(polygon_matrix)
# create these objects into a column: st_sfc
geom <- st_sfc(gm.multipt, gm.linestr, gm.poly)
# our normal (non-geom) dataframe
mock_data <- data.frame(objects = c('multipt', 'linestr', 'polyg'))
# append our geom data to our data_frame, declare it as a sf object
sf_mockdata <- st_sf(mock_data, geometry = geom)
# plot our shapes!
ggplot() +
geom_sf(data=sf_mockdata)
#| code-fold: true
setwd("C:/Users/T14/7Programming/R/class/geospatial/notes/01/")
airports <- st_read("ne_10m_airports/ne_10m_airports.shp")
gmsf.world <- world # empty world map
ggplot() +
geom_sf(data=gmsf.world) +
geom_sf(data=airports, aes(color=type)) +
labs(title = "Airport Types, World") +
theme_minimal() +
theme(title = element_text(hjust = 0.5))
# # export data as a csv file
# fwrite(x = df.merged,file = 'merged_dataset.csv', sep = '\t')
#
# ## bonus case: Stata Files
# # symbols in the column names. Replace them with '_':
# setnames(df.merged, gsub('\\.', '_',tolower(names(df.merged))))
# # Exporting it:
# write_dta(data = df.merged, path = 'merged_dataset.dta')
library(reticulate)
use_virtualenv("r-reticulate")
reticulate::repl_python()
ggplot() +
geom_sf(data=gmsf.world) +
geom_sf(data=airports, aes(color=type)) +
labs(title = "Airport Types, World") +
theme_minimal() +
theme(axis.title = element_text(hjust = 0.5))
ggplot() +
geom_sf(data=gmsf.world) +
geom_sf(data=airports, aes(color=type)) +
labs(title = "Airport Types, World") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
ggplot() +
geom_sf(data=gmsf.world) +
geom_sf(data=airports, aes(color=type)) +
labs(title = "Airport Types, World") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), face="bold")
ggplot() +
geom_sf(data=gmsf.world) +
geom_sf(data=airports, aes(color=type)) +
labs(title = "Airport Types, World") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, face="bold"))
ggplot() +
geom_sf(data=sf_mockdata) +
theme_minimal()
geom_point <- c(2,4)
st_point(geom_point)
# single point
geom_point <- c(2,4)
st_point(geom_point)
geom_multipoints <- rbind(c(2,4), c(1,5), c(0,2), c(1,0))
st_multipoint(geom_multipoints)
class(geom_multipoints)
class(geom_point)
class(geom_point)
geom_point
# multiple points
geom_multipoints <- rbind(c(2,4), c(1,5), c(0,2), c(1,0))
st_multipoint(geom_multipoints)
class(st_multipoint())
class(st_multipoint)
class(geom_multipoint)
class(st_multipoint(geom_multipoints))
# single line
geom_multipoints <- rbind(c(2,4), c(1,5), c(0,2), c(1,0))
st_linestring(geom_multipoints)
# single point
geom_point <- c(2,4)
single_pt <- st_point(geom_point)
single_pt
# single point
geom_point <- c(2,4)
single_pt <- st_point(geom_point)
char(single_pt)
# single point
geom_point <- c(2,4)
single_pt <- st_point(geom_point)
as.char(single_pt)
as.character(single.pt)
# single point
geom_point <- c(2,4)
single_pt <- st_point(geom_point)
as.character(single.pt)
as.character(single_pt)
# single point
geom_point <- c(2,4)
single_pt <- st_point(geom_point)
print(single_pt)
geom_multilines <- rbind(c(2,4), c(1,5), c(0,2), c(1,0),
c(0,0), c(1,1), c(2,2), c(3,3),
c(1,1), c(1,0), c(1,-1))
multi_lines <- st_multilinestring(geom_multilines)
geom_multilines <- list(rbind(c(2,4), c(1,5), c(0,2), c(1,0)),
rbind(c(0,0), c(1,1), c(2,2), c(3,3)),
rbind(c(1,1), c(1,0), c(1,-1)))
st_multilinestring(geom_multilines)
# single point
geom_point <- c(2,4)
single_pt <- st_point(geom_point)
cat("<pre>", paste(capture.output(print(single_pt)), collapse="\n"), "</pre>")
# single point
geom_point <- c(2,4)
single_pt <- st_point(geom_point)
st_sfc(single_pt)
#| code-fold: true
# multipoint (think: long-lat)
multipt_matrix <- rbind(c(3.2, 4), c( 4, 4.6), c(3.8, 4.4),
c(3.5, 3.8), c(3.4, 3.6), c(3.9, 4.5))
gm.multipt <- st_multipoint(multipt_matrix)
# linestring (connecting pts; order matters)
linestring_matrix <- rbind(c(0, 3), c(0,4), c(1,5), c(2,5))
gm.linestr <- st_linestring(linestring_matrix)
# polygon (last pt & first pt must match)
polygon_matrix <- list(rbind(c(0,0), c(1,0), c(3,2), c(2,4),
c(1,4), c(0,0)))
gm.poly <- st_polygon(polygon_matrix)
# create these objects into a column: st_sfc
geom <- st_sfc(gm.multipt, gm.linestr, gm.poly)
# our normal (non-geom) dataframe
mock_data <- data.frame(objects = c('multipt', 'linestr', 'polyg'))
# append our geom data to our data_frame, declare it as a sf object
sf_mockdata <- st_sf(mock_data, geometry = geom)
# plot our shapes!
ggplot() +
geom_sf(data=sf_mockdata) +
theme_minimal()
angle <- seq(0, 2*pi, length.out = 100)
polygon_matrix <- list(list(rbind(c(0,0), c(1,0), c(3,2), c(2,4), c(1,4), c(0,0))),
list(rbind(c(3.5 + 0.5*cos(angle), 0.5 + 0.5*sing(angle)))))
polygon_matrix <- list(list(rbind(c(0,0), c(1,0), c(3,2), c(2,4), c(1,4), c(0,0))),
list(rbind(c(3.5 + 0.5*cos(angle), 0.5 + 0.5*sin(angle)))))
polygon_matrix
gm.poly <- st_multipolygon(polygon_matrix)
polygon_matrix <- list(list(rbind(c(0,0), c(1,0), c(3,2), c(2,4), c(1,4), c(0,0))),
list(cbind(c(3.5 + 0.5*cos(angle), 0.5 + 0.5*sin(angle)))))
gm.poly <- st_multipolygon(polygon_matrix)
polygon_matrix <- list(list(rbind(c(0,0), c(1,0), c(3,2), c(2,4), c(1,4), c(0,0))),
list(cbind(3.5 + 0.5*cos(angle), 0.5 + 0.5*sin(angle))))
polygon_matrix
st_multipolygon(polygon_matrix)
circle_coords <- cbind(3.5 + 0.5*cos(angle), 0.5 + 0.5*sin(angle))
angle <- seq(0, 2*pi, length.out = 100)
circle_coords <- cbind(3.5 + 0.5*cos(angle), 0.5 + 0.5*sin(angle))
polygon_matrix <- list(list(rbind(c(0,0), c(1,0), c(3,2), c(2,4), c(1,4), c(0,0))),
list(rbind(circle_coords, circle_coords[1,])))
gm.poly <- st_multipolygon(polygon_matrix)
geom <- st_sfc(gm.multipt, gm.linestr, gm.poly)
# our normal (non-geom) dataframe
mock_data <- data.frame(objects = c('multipt', 'linestr', 'polyg', 'circle'))
# append our geom data to our data_frame, declare it as a sf object
sf_mockdata <- st_sf(mock_data, geometry = geom)
# our normal (non-geom) dataframe
mock_data <- data.frame(objects = c('multipt', 'linestr', 'polyg'))
# append our geom data to our data_frame, declare it as a sf object
sf_mockdata <- st_sf(mock_data, geometry = geom)
# plot our shapes!
ggplot() +
geom_sf(data=sf_mockdata) +
theme_minimal()
geom_singlepoly <- list(rbind(c(2,4), c(1,5), c(0,2), c(1,0), c(2,4)))
single_poly <- st_polygon(geom_singlepoly)
st_as_text(single_poly)
# single line
geom_multilines <- list(list(rbind(c(3,4), c(3,3), c(5,3), c(5,4), c(3,4))), # rectangle
list(rbind(c(1,4), c(1,5), c(2,4), c(1,4)))) # right triangle
multi_poly <- st_multipolygon(geom_multipoly)
# single line
geom_multipoly <- list(list(rbind(c(3,4), c(3,3), c(5,3), c(5,4), c(3,4))), # rectangle
list(rbind(c(1,4), c(1,5), c(2,4), c(1,4)))) # right triangle
multi_poly <- st_multipolygon(geom_multipoly)
st_as_text(multi_poly)
df.cities <- data.frame(
name = c('Bologna', 'London', 'Madrid', 'Paris'),
temperature = c(31, 21, 29,28),
language = c('Italian', 'English', 'Spanish', 'French'),
longitude = c(11.3,-0.1,-3.7,2.3),
latitude = c(44.4,51.5, 40.4,48.8)
)
sf.cities <- st_as_sf(df.cities,coords = c('longitude', 'latitude'))
sf.cities
gm.point <- st_point(c(11.3, 44.4)) # c(longitude,latitude)
gmc.point <- st_sfc(gm.point,crs = 'EPSG:4326')
gmc.point
st_as_text(gmc.point)
gmc.point
gmc.point <- st_sfc(gm.point,
CRS = 'EPSG:4326')
gmc.point <- st_sfc(gm.point,
crs = 'EPSG:4326')
st_as_text(sf.cities)
sf.cities
git status
